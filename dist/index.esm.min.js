function e(e){var t=JSON.stringify(e);return JSON.parse(t)}function t(e,t){return JSON.stringify(e)===JSON.stringify(t)}function r(e){var t=!1;return null!=e&&(t=!0),t}function i(t,r,i){var a=r;if(i&&(a=e(r)),t)for(var n=t.split("-"),o=0,p=n.length;o<p;o++){var l=n[o];l&&(a=a&&a[l])}return a}function a(t,r,i){var a=r;if(i&&(a=e(r)),t)for(var n=t.split("-"),o=0,p=n.length;o<p;o++){var l=n[o];if("0"!==l||"array"!==a.format&&"radio"!==a.format&&"select"!==a.format||!a.items){if(l){var d="0";if(a.propertyOrder)d=a.propertyOrder[l];else if(a.properties){d=Object.keys(a.properties)[l]}a=a.properties[d]}}else a=a.items}return a}function n(e,t){for(var r=t,i="",a=e.split("-"),n=0,o=a.length;n<o;n++){var p=a[n];if("0"===p&&r.items)r=r.items,i=i?i+"-items":"items";else if(p){var l="0";if(r.propertyOrder)l=r.propertyOrder[p];else if(r.properties){l=Object.keys(r.properties)[p]}r=r.properties[l],i=i?i+"-"+l:l}}return i}var o={type:"object",format:"event",title:"事件",isRequired:!1,readOnly:!1,properties:{type:{type:"string",default:"emit",format:"typeSelect",enum:["on","emit"],enumextra:["on","emit"],title:"事件类型",isRequired:!1,readOnly:!1},trigger:{type:"string",format:"input",default:"eventName",title:"触发事件",description:"用于输入触发事件的名称",placeholder:"请输入触发事件的名称",isRequired:!1,readOnly:!1},eventData:{type:"string",title:"事件数据",format:"json",default:"{}",description:"传递给触发事件的数据对象",isRequired:!1,readOnly:!1}},required:["type","trigger","eventData"],propertyOrder:["type","trigger","eventData"]},p={type:"object",format:"datasource",title:"数据源",readOnly:!1,properties:{type:{type:"string",default:"local",format:"typeSelect",enum:["local","remote"],enumextra:["local","remote"],title:"数据源类型"},data:{type:"string",title:"本地json数据",placeholder:"请输入静态json数据",format:"json",default:"{}",description:"用于设置本地的静态json数据",isRequired:!0},filter:{type:"string",title:"过滤器",format:"codearea",default:"() => {}",description:"用于定义过滤当前数据的函数",isRequired:!0}},required:["type","data","filter"],propertyOrder:["type","data","filter"]},l={type:"local",config:{dataName:"",body:{},filter:"return data;"},data:"{}",localFilter:"return data;"},d={jsonschema:{type:"object",title:"jsonSchemaObject",properties:{func:{type:"object",format:"func",title:"功能设置",readOnly:!0,properties:{a:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["a"],propertyOrder:["a"]},style:{type:"object",format:"style",title:"样式设置",readOnly:!0,properties:{b:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["b"],propertyOrder:["b"]},data:{type:"object",format:"data",title:"数据设置",readOnly:!0,properties:{c:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["c"],propertyOrder:["c"]}},required:["func","style","data"],propertyOrder:["func","style","data"]},input:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},boolean:{type:"boolean",title:"布尔值",format:"boolean",default:!1,description:"",isRequired:!1,readOnly:!1},object:{type:"object",format:"object",title:"对象Object",description:"",isRequired:!1,readOnly:!1,properties:{a:{type:"string",title:"单文本框",format:"input",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["a"],propertyOrder:["a"]},array:{type:"array",format:"array",title:"数组Array",description:"",isRequired:!1,readOnly:!1,items:{type:"object",format:"object",title:"数组项",description:"",isRequired:!1,readOnly:!1,properties:{name:{type:"string",format:"input",title:"名字",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1}},required:["name"],propertyOrder:["name"]}},"empty-array":{type:"array",format:"array",title:"数组Array",description:"",items:{type:"object",format:"object",title:"数组项",description:"",properties:{}}},"empty-object":{type:"object",format:"object",title:"对象Object",description:"",properties:{}},url:{type:"string",title:"链接地址url",format:"url",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},textarea:{type:"string",title:"多行文本框",format:"textarea",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},color:{type:"string",title:"颜色color",format:"color",default:"#ffffff",description:"",isRequired:!1,readOnly:!1},image:{type:"string",title:"图片",format:"image",default:"",description:"上传图片",imgWidth:200,imgHeight:200,imgRatioReadOnly:!0,templateId:"",isRequired:!1},number:{type:"number",title:"数量number",format:"number",default:1,minimum:0,maximum:1e3,description:"",isRequired:!1,readOnly:!1},json:{type:"string",title:"json数据",format:"json",default:"{}",description:"",isRequired:!1,readOnly:!1},codearea:{type:"string",title:"函数类型",format:"codearea",placeholder:"请输入函数方法",default:'function func() { console.log("hello, world!"); }',description:"用于定义函数方法",isRequired:!1,readOnly:!1},htmlarea:{type:"string",title:"富文本",format:"htmlarea",placeholder:"请输入html代码片段",default:"<p>hello,world!</p>",description:"用于放置html代码片段",isRequired:!1,readOnly:!1},"text-editor":{type:"string",title:"富文本",format:"text-editor",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},date:{type:"string",title:"日期Date",format:"date",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},"date-time":{type:"string",title:"日期时间",format:"date-time",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},time:{type:"string",title:"时间Time",format:"time",default:"",description:"",placeholder:"",isRequired:!1,readOnly:!1},quantity:{type:"object",format:"quantity",title:"单位计量",isRequired:!1,readOnly:!1,properties:{unit:{type:"number",title:"单位数值",format:"number",default:50,minimum:0,maximum:1e3,description:"",isRequired:!1,readOnly:!1},quantity:{type:"string",format:"typeSelect",default:"px",enum:["px","rem","em","%"],enumextra:["px","rem","em","%"],title:"单位类型",isRequired:!1,readOnly:!1}},required:["unit","quantity"],propertyOrder:["unit","quantity"]},radio:{type:"string",title:"单选",format:"radio",items:{type:"string",enum:["a","b","c"],enumextra:["选项a","选项b","选项c"]},description:"",isRequired:!1,readOnly:!1},select:{type:"array",title:"多选",format:"select",items:{type:"string",enum:["a","b","c"],enumextra:["选项a","选项b","选项c"]},description:"",isRequired:!1,readOnly:!1},"dynamic-data":{type:"object",format:"dynamic-data",title:"动态数据源",readOnly:!1,properties:{type:{type:"string",default:"local",format:"typeSelect",enum:["local","remote"],enumextra:["本地数据","接口数据"],title:"数据类型"},config:{type:"object",title:"接口配置",format:"object",description:"用于存放接口的配置数据(url、请求参数等)",isRequired:!0,properties:{dataName:{type:"string",default:"local",format:"typeSelect",enum:["local","remote"],enumextra:["本地数据","接口数据"],title:"数据类型"},body:{type:"object",title:"请求参数配置",format:"object",description:"用于配置当前接口的请求参数数值",isRequired:!0},filter:{type:"string",title:"过滤器函数体",format:"codearea",default:"return data;",description:"用于定义过滤接口数据",isRequired:!0}},required:["dataName","body","filter"],propertyOrder:["dataName","body","filter"]},data:{type:"string",title:"数据内容",format:"json",default:"{}",description:"用于存放DynamicData的数据内容",isRequired:!0},localFilter:{type:"string",title:"过滤器",format:"codearea",default:"return data;",description:"用于定义过滤本地数据",isRequired:!0}},required:["type","config","data","localFilter"],propertyOrder:["type","config","data","localFilter"]},datasource:p,event:o,widget:{type:"string",title:"内嵌组件数据",format:"widget",default:"{}",description:"用于存放内嵌组件的渲染相关数据",isRequired:!1,readOnly:!0}},u={on:{type:"object",format:"event",title:"事件",isRequired:!1,readOnly:!1,properties:{type:{type:"string",default:"on",format:"typeSelect",enum:["on","emit"],enumextra:["on","emit"],title:"事件类型",isRequired:!1,readOnly:!1},register:{type:"string",format:"input",default:"eventName",title:"注册事件",description:"用于输入注册事件的名称",placeholder:"请输入注册事件的名称",isRequired:!1,readOnly:!1},actionFunc:{type:"string",title:"执行函数",format:"codearea",default:"() => {}",description:"",isRequired:!1,readOnly:!1}},required:["type","register","actionFunc"],propertyOrder:["type","register","actionFunc"]},emit:o},s={local:p,remote:{type:"object",format:"datasource",title:"数据源",readOnly:!1,properties:{type:{type:"string",default:"remote",format:"typeSelect",enum:["local","remote"],enumextra:["local","remote"],title:"数据源类型"},data:{type:"string",title:"远程json数据",placeholder:"请输入远程json数据源地址",format:"url",default:"http://xxx",isRequired:!0,description:"用于设置获取元素数据的请求地址"},filter:{type:"string",title:"过滤器",format:"codearea",default:"() => {}",description:"用于定义过滤当前数据的函数",isRequired:!0}},required:["type","data","filter"],propertyOrder:["type","data","filter"]}};function f(e){return/^http[s]?:\/\/.*/.test(e)}function c(e){return"String"===Object.prototype.toString.call(e).slice(8,-1)}function y(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function m(e){return"Boolean"===Object.prototype.toString.call(e).slice(8,-1)}function g(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function O(e){return/^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}$/.test(e)||/^\d{4}-\d{2}-\d{2}\s\d{2}:\d{2}:\d{2}$/.test(e)}function v(e){return/^\d{2}:\d{2}:\d{2}$/.test(e)||/^\d{2}:\d{2}$/.test(e)}function b(e){var t=!1;return"Array"===Object.prototype.toString.call(e).slice(8,-1)&&(t=!0),t}function j(e){if(!b(e))return!1;for(var t=0,r=e.length;t<r;t++){if(!c(e[t]))return!1}return!0}function q(e){var t=!1;return"Object"===Object.prototype.toString.call(e).slice(8,-1)&&(t=!0),t}function h(e){var t=!1;return d.quantity.properties.quantity.enum.indexOf(e)>=0&&(t=!0),t}function R(e){return/^#[0-9a-f]{6}$/.test(e)||/^#[0-9a-f]{3}$/.test(e)}function x(e){var t=!1;return"Function"===Object.prototype.toString.call(e).slice(8,-1)&&(t=!0),t}function N(t){return t&&q(t)?function(t){var r;if(q(t)){var i=Object.keys(t);t.data&&t.filter&&2===i.length?r=b(t.data)||q(t.data)?e(s.local):e(s.remote):t.trigger&&t.eventData&&2===i.length?r=e(u.emit):t.register&&t.actionFunc&&2===i.length?r=e(u.on):t.quantity&&h(t.quantity)&&2===i.length?r=e(d.quantity):(r=e(d["empty-object"]),Object.keys(t).map((function(e){var i=t[e];r.properties[e]=N(i)})))}return r}(t):t&&b(t)?function(t){var r;if(t&&b(t))if(j(t)){(r=e(d.select)).items.enum=t;var i=r.items.enumextra.length,a=t.length;if(a>i)for(var n=i,o=a;n<o;n++)r.items.enumextra.push("选项"+t(n))}else{r=e(d["empty-array"]);var p=N(t[0]);r.items.properties=p.properties}return r}(t):function(t){var r="";if(m(t))r=e(d.boolean);else if(y(t))r=e(d.number);else if(f(t))r=e(d.url);else if(g(t))r=e(d.date);else if(O(t))r=e(d["date-time"]);else if(v(t))r=e(d.time);else if(R(t))r=e(d.color);else try{r=y(JSON.parse(t))?e(d.input):e(d.json)}catch(i){r=t&&t.length>30?e(d.textarea):e(d.input)}return r}(t)}function S(e){var t=e&&e.format;return t||(t=e&&e.type?e.type:"input"),t}function F(e){var t=!0;if(!e)return t;var r=S(e);return("object"===r&&e.properties&&e.propertyOrder&&e.propertyOrder.length>0||"array"===r&&e.items&&e.items.properties&&e.items.propertyOrder&&e.items.propertyOrder.length>0||e.type&&"array"!==e.type&&"object"!==e.type||e.format)&&(t=!1),t}function k(e){var t=!0;if(e&&("object"===S(e)&&e.properties&&e.propertyOrder&&e.propertyOrder.length>0)){var r=e.properties.func||{},i=e.properties.style||{},a=e.properties.data||{};(r.propertyOrder&&r.propertyOrder.length>0||i.propertyOrder&&i.propertyOrder.length>0||a.propertyOrder&&a.propertyOrder.length>0)&&(t=!1)}return t}function D(e){var t=!1;e&&("object"===S(e)&&e.properties&&e.propertyOrder&&e.properties.func&&e.properties.style&&e.properties.data&&(t=!0));return t}function w(e){var t=!1,r=e.lastUpdateTime,i=new Date("2020-07-29T07:30:00.691Z").getTime();return r&&new Date(r).getTime()>=i&&(t=!0),t}function J(e){var t=!1;return"func"!==e&&"style"!==e&&"data"!==e&&"widgets"!==e&&"object"!==e||(t=!0),t}function $(e){var t=!1;return"func"!==e&&"style"!==e&&"data"!==e&&"widgets"!==e||(t=!0),t}function T(e){var t=!0;return"object"===(e.type||S(e))&&e.propertyOrder&&e.properties?e.propertyOrder.map((function(r){var i=e.properties[r];"object"===(e.type||S(i))&&i.propertyOrder&&i.properties||(t=!1)})):t=!1,t}function A(e,t){var r=e.split("-"),i=t.split("-");return r.pop(),i.pop(),r.join("-")===i.join("-")}function U(e,t){for(var r=e.split("-"),i=t.split("-"),a="before",n=0,o=(r.length>i.length?i:r).length;n<o;n+=1){Number(r[n])>Number(i[n])&&(a="after")}return a}function I(e){var t=e.split("-");return t.pop(),t.join("-")}function W(e){var t=e.split("-"),r=t.pop(),i=Number(r)+1;return t.push(""+i),t.join("-")}function B(e){var t=e.split("-"),r=t.pop();return[t.join("-"),r]}function H(e){var t=e.split("-"),r=t.pop();return t.push(Number(r)-1),t.join("-")}function L(e){var t=e.split("-"),r=t.pop();return t.push(Number(r)+1),t.join("-")}function Z(e,t){var r=t||{};if(q(e)&&"object"===e.type&&e.properties){(e.propertyOrder?e.propertyOrder:Object.keys(e.properties)).map((function(t){var i=e.properties[t];r=z(i,r)}))}return r}function z(e,t){var r=!t,i=t||{};if(e&&"{}"!==JSON.stringify(e)){var a=S(e);"object"===a||"func"===a||"style"===a||"data"===a?(!r&&i.object?i.object+=1:r||(i.object=1),i=Z(e,i)):"array"===a?(!r&&i.array?i.array+=1:r||(i.array=1),i=Z(e=e.items,i)):!r&&i[a]?i[a]+=1:r||(i[a]=1)}return i}function C(t){var i=e(t);if(!i.title&&i.description&&(i.title=i.description),i.format||(i.format=S(i)),"quantity"!==i.format&&"array"!==i.format&&"datasource"!==i.format&&"event"!==i.format&&"object"!==i.format&&"radio"!==i.format&&"select"!==i.format||!r(i.default)||delete i.default,"radio"===i.format&&(i.type="string",i.enum&&i.enumextra&&(i.items={type:"string",enum:e(i.enum),enumextra:e(i.enumextra)},delete i.enum,delete i.enumextra)),"quantity"===i.format){var a=i.properties,n=e(d.quantity);if(a.quantity&&q(a.quantity)&&a.quantity.default){var o=a.quantity.default;n.properties.quantity.default="percent"===o?"%":o}i=n}if("datasource"===i.format){var p=i.properties,l=p.type&&p.type.default,f=p.data&&p.data.default,c=p.filter&&p.filter.default;"local"===l?(i=e(s.local)).properties.data.default=f?e(f):"{}":(i=e(s.remote)).properties.data.default=f?e(f):"http://xxx",i.properties.filter.default=c?e(c):"() => {}"}if("event"===i.format){var y=i.properties,m=y.type&&y.type.default;if("in"===m||"on"===m){var g=y.filter&&y.filter.default||"() => {}";i=e(u.on),y.actionFunc&&q(y.actionFunc)&&(i.properties.actionFunc.default=y.actionFunc.default||e(g))}else{var O=y.filter&&y.filter.default||"{}";i=e(u.emit),y.eventData&&q(y.eventData)&&(i.properties.eventData.default=y.eventData.default||e(O))}}return i.properties&&(i.required=Object.keys(i.properties),i.propertyOrder||(i.propertyOrder=i.required),i.propertyOrder.map((function(e){i.properties[e]=C(i.properties[e])}))),i.items&&(i.items=C(i.items)),i}function E(e,t){var i="",a=t;r(a)&&r(e.default)&&typeof a!=typeof e.default&&(a=void 0);var n=r(a)?a:e.default;switch(e.type){case"string":if("typeSelect"===e.format)i=e.default;else if("color"===e.format)"#fff"!==n&&"#FFF"!==n||(n="#ffffff"),i=n||"#ffffff";else if("json"===e.format||"widget"===e.format){var o="";if(q(t)||b(t))o=t;else if(x(t)||""===t)o={};else try{o=JSON.parse(t)}catch(e){o={}}i=o}else i=r(n)?n:"";break;case"boolean":i=!!r(n)&&n;break;case"number":i=r(n)?n:1;break;default:i=r(n)?n:""}return i}function G(t,i){var a={},n=S(t);if(q(t)&&"object"===t.type){var o=t,p=i;r(p)&&r(o.default)&&typeof p!=typeof o.default&&(p=void 0);var d=r(p)?p:o.default;if("dynamic-data"===n)a=e(l),d&&q(d)&&"{}"!==JSON.stringify(d)&&(a=Object.assign(a,d));else if("datasource"===n)o.properties&&o.properties.type&&o.properties.type.default&&"local"===o.properties.type.default?(a={data:"{}",filter:"() => {}"},d&&d.data&&(a.data=d.data),d&&d.filter&&(a.filter=d.filter),"http://xxx"===a.data&&(a.data="{}")):(a={data:"http://xxx",filter:"() => {}"},d&&d.data&&(a.data=d.data),d&&d.filter&&(a.filter=d.filter),"{}"===a.data&&(a.data="http://xxx"));else if("event"===n)o.properties&&o.properties.type&&o.properties.type.default&&"emit"===o.properties.type.default?d&&"out"===d.type?a={trigger:d&&d.filter||"eventName",eventData:"{}"}:(a={trigger:"eventName",eventData:"{}"},d&&d.trigger&&(a.trigger=d.trigger),d&&d.eventData&&(a.eventData=d.eventData)):d&&"in"===d.type?a={register:"eventName",actionFunc:d&&d.filter||"() => {}"}:(a={register:"eventName",actionFunc:"() => {}"},d&&d.register&&(a.register=d.register),d&&d.actionFunc&&(a.actionFunc=d.actionFunc));else if(t.properties){(t.propertyOrder?t.propertyOrder:Object.keys(t.properties)).map((function(e){var r=t.properties[e],n=i&&i[e];switch(r.type){case"array":a[e]=K(r,n);break;case"object":a[e]=G(r,n);break;default:a[e]=E(r,n)}}))}}return a}function K(e,t){var i=[];if(e&&"array"===e.type){var a=t;r(a)&&r(e.default)&&typeof a!=typeof e.default&&(a=void 0);var n=r(a)?a:e.default;if("array"===e.format)if(b(n))n.map((function(t){i.push(G(e.items,t))}));else{var o=G(e.items,n);i.push(o)}else i=r(n)?n:[]}return i}function M(e,t){return"object"===e.type?G(e,t):"array"===e.type?K(e,t):E(e,t)}var P=d;function Q(e,t){var i=t||[];if(e&&"{}"!==JSON.stringify(e))if(q(e))if(e.type&&"remote"===e.type&&e.config&&q(e.config)&&e.config.dataName&&r(e.localFilter)&&r(e.data)){var a=e.config.body;if(a&&!q(a))try{a=JSON.parse(a)}catch(e){a={}}i.push({id:e.config.id,dataName:e.config.dataName,body:a})}else{Object.keys(e).map((function(t){Q(e[t],i)}))}else b(e)&&e.map((function(e){Q(e,i)}));return i}function V(e,t){var r=t||"data";return e.split("-").map((function(e){r=/^\d+$/.test(e)?r+"["+e+"]":r+"."+e})),r}function X(e,t){var r=[];q(e)?Object.keys(e).map((function(i){var a=e[i],n=t?t+"-"+i:i;q(a)||b(a)?r.push({title:i,value:n,key:n,children:X(a,n)}):r.push({title:i,value:n,key:n})})):b(e)&&e.map((function(e,i){var a=i.toString(),n=t?t+"-"+i:a;q(e)||b(e)?r.push({title:a,value:n,key:n,children:X(e,n)}):r.push({title:a,value:n,key:n})}));return r}function Y(e){var t=e.split("-");return t.pop(),t.join("-")}function _(e){var t=e.split("-"),r=t.pop();return[t.join("-"),r]}var ee=["key","enum","enumextra","items","input","boolean","number","color","url","textarea","text-editor","radio","select","date","date-time","time","json","codearea","htmlarea","quantity","dynamic-data","datasource","event","array","object","widget","widgets","widgetUUID","embedWidgetList"];export{s as DataSourceTypeList,u as EventTypeDataList,ee as KeyWordList,d as TypeDataList,V as dataRoute2dataPath,Q as dynamicDataAnalyzer,r as exitPropertie,U as getCurPosition,S as getCurrentFormat,i as getJsonDataByKeyRoute,W as getNextIndexRoute,I as getParentIndexRoute,B as getParentIndexRoute_CurIndex,Y as getParentKeyRoute,_ as getParentKeyRoute_CurKey,a as getSchemaByIndexRoute,n as indexRoute2keyRoute,b as isArray,m as isBoolean,J as isBoxSchemaData,R as isColor,g as isDateStr,O as isDateTimeStr,F as isEmptySchema,k as isEmptyWidgetSchema,t as isEqual,$ as isFirstSchemaData,x as isFunction,w as isNewSchemaData,y as isNumber,q as isObject,h as isQuantity,A as isSameParent,j as isSelect,c as isString,T as isStructuredSchema,v as isTimeStr,f as isURL,D as isUsedToWidgetConfig,N as json2schema,X as json2treeData,z as metaElemAnalyzer,L as moveBackward,H as moveForward,e as objClone,C as oldSchemaToNewSchema,M as schema2json,P as schemaMetaList};
